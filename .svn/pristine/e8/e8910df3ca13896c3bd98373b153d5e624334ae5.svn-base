function has_setcookie(n,t){var r=document.domain.split(".").slice(-2).join("."),i=Url.queryString(t);i&&(i=$.trim(i),Cookies.set(n,i,{domain:r}))}function isMobileEquipment(){var n=navigator.userAgent.toLowerCase(),t=n.match(/ipad/i)=="ipad",i=n.match(/iphone/i)=="iphone",r=n.match(/android/i)=="android";return t||i||r}var store=new Vuex.Store({state:{shoppingCartList:[]},mutations:{updateCart:function(n,t){n.shoppingCartList=t}},getters:{},actions:{initCart:function(n){$.get("/Market/ShoppingCart/GetList",function(t){t.Rstatus&&n.commit("updateCart",t.Rdata)})},addCart:function(n,t){$.post("/Market/ShoppingCart/Update",{productId:t.ProductId,quantity:1},function(i){if(i.Rstatus){var r=n.state.shoppingCartList,u=$linq(r).firstOrDefault(function(n){return n.ProductId==t.ProductId});u?u.Quantity+=t.Quantity:r.push(t);n.commit("updateCart",r)}})},updateCart:function(n,t){var i=n.state.shoppingCartList,r=$linq(i).firstOrDefault(function(n){return n.ProductId==t.ProductId});r&&(r.Quantity+=t.Quantity,r.Quantity>0?$.post("/Market/ShoppingCart/Update",{productId:t.ProductId,quantity:t.Quantity},function(t){t.Rstatus&&n.commit("updateCart",i)}):(i=$linq(n.state.shoppingCartList).where(function(n){return n.ProductId!=t.ProductId}).toArray(),$.post("/Market/ShoppingCart/Delete",{productId:t.ProductId},function(t){t.Rstatus&&n.commit("updateCart",i)})))},deleteCart:function(n,t){$.post("/Market/ShoppingCart/Delete",{productId:t},function(i){if(i.Rstatus){var r=$linq(n.state.shoppingCartList).where(function(n){return n.ProductId!=t}).toArray();n.commit("updateCart",r)}})}}}),shared_layout_shortcut,shared_layout_toper;$(function(){var r=$("#shared_layout_toper"),t=$("#shared_layout_header"),i=$("#shared_layout_shortcut"),n;$(window).scroll(function(){var n=$(window).scrollTop(),u=r.height();n>u?(t.addClass("navbar-fixed-top"),i.find(".goptop").show()):(t.removeClass("navbar-fixed-top"),i.find(".goptop").hide())});window.easemobim=window.easemobim||{};easemobim.config={tenantId:"34822",hide:!0,autoConnect:!0,dialogPosition:{x:"60px",y:"30px"}};i.on("click","a.list-group-item.sidebar,div.panel-heading>a.pull-right",function(){var n=$(this).attr("data-target").replace("#",""),t=$(".panel.panel-default");t.each(function(t,i){$(i).is("[show]")||n!=i.id?$(i).removeAttr("show").animate({right:-400},"slow"):$(i).attr("show",!0).animate({right:60,opacity:1},"slow")})}).on("click",".goptop",function(){$("html, body").animate({scrollTop:0},700,function(){t.removeClass("navbar-fixed-top")})});$("#lks_modal,#lks_modal_lg,#lks_modal_sm").on("hidden.bs.modal",function(){$(this).removeData("bs.modal");$(this).find("div.modal-content").empty()});$("#shared_block_news .news-list").lksscroll({line:1,speed:500,timer:5e3,up:"shared_news_down",down:"shared_news_up"});$("a.gensee-enter").each(function(){var n=$(this).data("dialogid"),t=$(this).data("nickname"),i=$(this).data("token"),r="http://meteni.gensee.com/training/site/s/"+n+"?nickname="+encodeURIComponent(t)+"&token="+i+"&sec=md5";$(this).attr("href",r).attr("target","_blank")});try{$("#shared_layout_toper a[data-lang]").on("click",function(){var n=$(this).data("lang");$.post("/Shared/SetLanguage",{languageType:n},function(){location.reload(!0)})})}catch(u){}try{$("a.gensee-video").each(function(){var n=$(this).data("dialogid"),t="http://meteni.gensee.com/training/site/v/"+n+"?nickname="+encodeURIComponent("为您提供英语口语服务");$(this).attr("href",t).attr("target","_blank")});$("a.gensee-enter").each(function(){var n=$(this).data("dialogid"),t=$(this).data("nickname"),i=$(this).data("token"),r="http://meteni.gensee.com/training/site/s/"+n+"?nickname="+encodeURIComponent(t)+"&token="+i+"&sec=md5";$(this).attr("href",r).attr("target","_blank")})}catch(u){}has_setcookie(branchidkey,"branchId");has_setcookie(tidkey,"tid");has_setcookie(utmfromkey,"utm_from");has_setcookie(utmcampaignKey,"utm_campaign");n=document.referrer;n&&n.length>0&&Cookies.set(utmreferrerkey,n)});document.getElementById("shared_layout_shortcut")!==null&&(shared_layout_shortcut=new Vue({el:"#shared_layout_shortcut",data:{orderCount:0,orderList:[]},created:function(){self=this;store.dispatch("initCart");$.get("/Market/Order/GetUnOrderCount",function(n){n.Rstatus&&n.Rdata>0&&(self.orderCount=n.Rdata)})},methods:{updateCart:function(n){store.dispatch("deleteCart",n)},getOrderList:function(){var n=this;n.orderList.length==0&&$.get("/Market/Order/GetUnOrderList",function(t){t.Rstatus&&(n.orderList=t.Rdata)})},goPay:function(n){window.location.href="/Market/Payment/Online?id="+n},cancelOrder:function(n){$.post("/Market/Order/CancelOrder",{id:n},function(t){t.Rstatus&&(self.orderList=$linq(self.orderList).where(function(t){return t.Id!=n}).toArray(),self.orderCount-=1)})},formatThousands:function(n){return n?n.lksFormatThousands():null}},computed:{goodsList:function(){return store.state.shoppingCartList},totalNumber:function(){var n=0;return this.goodsList.map(function(t){n+=t.Quantity}),n},totalPrice:function(){var n=0;return this.goodsList.map(function(t){n+=t.Price*t.Quantity}),this.formatThousands(n)}}}));document.getElementById("shared_layout_toper")!=null&&(shared_layout_toper=new Vue({el:"#shared_layout_toper",data:{lang:{download_software:common_lang.download_software,exit:common_lang.logout,signup_free:common_lang.signup_free,signin:common_lang.signin,enter_student:common_lang.enter_student_center,enter_teacher:common_lang.enter_teacher_center,enter_manager:common_lang.enter_manager_center}}}))